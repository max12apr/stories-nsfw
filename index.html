<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OBSIDIAN – Netflix of Forbidden Stories</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: { netflix: '#e50914', dark: '#141414', gold: '#c6a15b' },
      fontFamily: { serif: ['Playfair Display','serif'], body: ['Inter','sans-serif'] }
    }
  }
}
</script>
<style>
/* Scrollbar hide for horizontal rows */
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
/* Hover card scaling */
.card:hover { transform: scale(1.05); transition: 0.3s; cursor: pointer; }
/* Video autoplay card */
.card video { position: absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:0; }
.card img { width:100%; height:100%; object-fit:cover; border-radius:0.5rem; }
</style>
</head>
<body class="bg-dark text-white font-body">

<!-- AGE GATE -->
<div id="ageGate" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90">
  <div class="bg-dark p-8 rounded text-center border border-white/20">
    <h2 class="text-2xl mb-3 font-serif">Private Library</h2>
    <p class="text-sm text-gray-400 mb-6">Mature themes. 18+ only.</p>
    <button onclick="enter()" class="bg-netflix px-6 py-2 rounded font-semibold">Enter</button>
  </div>
</div>

<!-- NAVBAR -->
<header class="fixed top-0 w-full z-40 bg-black/80 backdrop-blur">
  <div class="flex items-center gap-8 px-8 py-4">
    <div class="text-netflix font-bold text-2xl font-serif">OBSIDIAN</div>
  </div>
</header>

<!-- HERO -->
<section class="relative h-[60vh] mt-16">
  <video id="heroVideo" autoplay muted loop class="absolute inset-0 w-full h-full object-cover opacity-60"></video>
  <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div>
  <div class="relative z-10 px-12 pt-20 max-w-xl">
    <h1 id="heroTitle" class="text-4xl font-bold mb-4 font-serif">Loading Story...</h1>
    <p id="heroSubtitle" class="text-gray-300 mb-6">Please wait</p>
    <div class="flex gap-3">
      <button onclick="openPlayer(currentStoryId)" class="bg-white text-black px-6 py-2 rounded font-semibold">▶ Read</button>
    </div>
  </div>
</section>

<!-- LIBRARY ROWS -->
<section id="library" class="px-8 mt-8 space-y-10"></section>

<!-- STORY PLAYER MODAL -->
<div id="player" class="fixed inset-0 bg-black/95 z-50 hidden overflow-y-auto flex justify-center items-start pt-12">
  <div class="bg-dark rounded-lg flex max-w-6xl w-full shadow-lg">
    
    <!-- LEFT: Character Panel -->
    <div id="characterPanel" class="w-1/3 bg-gray-900 p-4 space-y-6 overflow-y-auto">
      <!-- Dynamic characters here -->
    </div>

    <!-- RIGHT: Story Content -->
    <div class="w-2/3 p-6 relative">
      <button onclick="closePlayer()" class="absolute top-3 right-3 text-3xl text-gray-300 hover:text-white z-20">✕</button>
      <video id="playerVideo" autoplay muted loop class="absolute inset-0 w-full h-full object-cover opacity-20 z-0"></video>
      <div class="relative z-10">
        <h2 id="playerTitle" class="text-2xl font-serif mb-4"></h2>
        <div id="playerContent" class="space-y-4 text-gray-200 leading-relaxed overflow-y-auto max-h-[80vh]"></div>
        <div class="mt-6 flex justify-between">
          <button onclick="shareReddit()" class="bg-netflix px-4 py-2 rounded">Share on Reddit</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// --- Inline JSON Data ---
const stories = [
  {
    "id": "1",
    "title": "Brother-in-law catches my husband...",
    "subtitle": "A forbidden holiday affair escalates...",
    "tldr": "Thanksgiving peeping turns into full cheating...",
    "category": "Forbidden Affairs",
    "author": "Anonymous",
    "readTime": "10 min",
    "heroVideo": "https://www.w3schools.com/howto/rain.mp4",
    "images": [
      "https://thumbs.dreamstime.com/b/delicious-thanksgiving-dinner-table-roasted-turkey-seasonal-decor-cozy-thanksgiving-dinner-setup-roasted-turkey-425226209.jpg",
      "https://images.stockcake.com/public/7/6/5/76522662-fca3-46a4-97f8-afc589214790_large/family-christmas-gathering-stockcake.jpg"
    ],
    "content": "Thanksgiving weekend, whole family crammed into our house... [full text here]"
  },
  {
    "id": "2",
    "title": "My Best Friend's Mom Seduced Me in the Pool House",
    "subtitle": "Late-night swim turns into lessons...",
    "tldr": "MILF neighbor takes advantage of college break.",
    "category": "Holiday Confessions",
    "author": "CollegeKid22",
    "readTime": "8 min",
    "heroVideo": "https://www.w3schools.com/howto/rain.mp4",
    "images": [
      "https://images.unsplash.com/photo-1560272564-c83b19b38190",
      "https://images.unsplash.com/photo-1600585154340-be6161a56a0c"
    ],
    "content": "It was the summer after freshman year... [full text here]"
  }
];

const media = [
  {
    "type": "image",
    "imageURL": "https://imagine-public.x.ai/imagine-public/share-videos/0dfe6abd-934d-46e0-aae5-1a33321448a3_thumbnail.jpg",
    "videoURL": ""
  },
  {
    "type": "video",
    "imageURL": "https://imagine-public.x.ai/imagine-public/share-videos/0dfe6abd-934d-46e0-aae5-1a33321448a3_thumbnail.jpg",
    "videoURL": "https://assets.grok.com/users/d42b3f99-8413-4a6e-987d-7262c1b9767b/xDQISf9bWLEhMvkp-profile-picture.webp"
  }
];

let currentStoryId = null;

// --- Functions ---
function enter() { document.getElementById('ageGate').style.display='none'; }

function buildLibrary() {
  const library = document.getElementById('library');
  const categories = [...new Set(stories.map(s=>s.category))];
  categories.forEach(cat=>{
    const row = document.createElement('div');
    row.innerHTML = `<h2 class="text-xl mb-3">${cat}</h2>
      <div class="flex gap-3 overflow-x-auto no-scrollbar">
        ${stories.filter(s=>s.category===cat).map(s=>{
          // pick a media image/video randomly
          const mediaItem = media[Math.floor(Math.random()*media.length)];
          return `<div class="min-w-[220px] h-[130px] relative rounded-lg overflow-hidden card" onclick="openPlayer('${s.id}')">
            <img src="${mediaItem.imageURL}" class="absolute inset-0 w-full h-full object-cover z-0"/>
            ${mediaItem.videoURL?`<video muted loop class="absolute inset-0 w-full h-full object-cover opacity-0 z-10">${mediaItem.videoURL}</video>`:''}
            <div class="absolute bottom-0 left-0 p-2 bg-black/50 w-full text-xs text-gray-200">${s.title}</div>
          </div>`;
        }).join('')}
      </div>`;
    library.appendChild(row);
  });

  // set hero
  const hero = stories[0];
  currentStoryId = hero.id;
  document.getElementById('heroTitle').innerText = hero.title;
  document.getElementById('heroSubtitle').innerText = hero.subtitle;
  document.getElementById('heroVideo').src = hero.heroVideo;
}

function openPlayer(id) {
  const story = stories.find(s=>s.id===id);
  currentStoryId = id;
  document.getElementById('playerTitle').innerText = story.title;
  document.getElementById('playerContent').innerHTML = story.content.split('\n').map(p=>`<p>${p}</p>`).join('');
  document.getElementById('playerVideo').src = story.heroVideo;

  // left character panel
  const charPanel = document.getElementById('characterPanel');
  charPanel.innerHTML = '';
  // For prototype, pick two random media items as characters
  const chars = [media[Math.floor(Math.random()*media.length)], media[Math.floor(Math.random()*media.length)]];
  chars.forEach((c,i)=>{
    charPanel.innerHTML += `
      <div class="bg-gray-800 rounded p-2 flex flex-col items-center">
        <img src="${c.imageURL}" class="w-full h-40 object-cover rounded mb-2"/>
        <h3 class="text-gold font-serif">Character ${i+1}</h3>
        <p class="text-xs text-gray-400">Traits placeholder</p>
      </div>`;
  });

  document.getElementById('player').classList.remove('hidden');
}

function closePlayer() { document.getElementById('player').classList.add('hidden'); }

function shareReddit() {
  const story = stories.find(s=>s.id===currentStoryId);
  const title = encodeURIComponent("A forbidden story: "+story.title);
  const url = encodeURIComponent(window.location.href);
  window.open(`https://www.reddit.com/submit?title=${title}&url=${url}`, '_blank');
}

// Hover video logic
document.addEventListener('mouseover', e=>{
  if(e.target.closest('.card') && e.target.closest('.card').querySelector('video')){
    const vid = e.target.closest('.card').querySelector('video');
    vid.style.opacity=1;
    vid.play();
  }
});
document.addEventListener('mouseout', e=>{
  if(e.target.closest('.card') && e.target.closest('.card').querySelector('video')){
    const vid = e.target.closest('.card').querySelector('video');
    vid.style.opacity=0;
    vid.pause();
  }
});

// --- INIT ---
document.addEventListener('DOMContentLoaded', buildLibrary);
</script>
</body>
</html>
